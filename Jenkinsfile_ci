pipeline{
agent any
environment{
name = "Yusha Iqbal"
project_description = "This is Jenkins Project I am creating to understand and master Jenkinsd pipeline build with maven"
}
parameters{
choice(name:'Branch_Name',choices:['main','feature-yusha'],description:'giving the branch choice')
}
stages{
stage('Introducing my self'){
steps{
sh 'echo "Hello my name is $name" '
}
}
stage('description of the project'){
steps{
echo "${env.project_description}"
}
}
stage('adding git checkout'){
when{
expression{
env.BRANCH_NAME == 'feature-yusha'
}
}
steps{
git branch: '$Branch_Name', credentialsId: 'ibt_yusha_github', url: 'https://github.com/IBT-learning/DevOps-Git.git'
}
}
stage('validate'){
steps{
withMaven(maven: 'maven_3.8') {
    sh 'mvn validate'
}
}
}
stage('compile'){
steps{
withMaven(maven: 'maven_3.8') {
    sh 'mvn compile'
}
}
}
stage('test'){
steps{
withMaven(maven: 'maven_3.8') {
    sh 'mvn test'
}
}
}
stage('Sonar Qube analysis'){
environment {
SonarScann = tool 'ibt-sonarqube';
}
steps{
withSonarQubeEnv(credentialsId: 'student-sonar-token', installationName: 'IBT sonarqube'){
sh "${env.SonarScann}/bin/sonar-scanner"
}
}
}
stage('package'){
steps{
withMaven(maven: 'maven_3.8') {
    sh 'mvn package'
}
}
}
}
}
